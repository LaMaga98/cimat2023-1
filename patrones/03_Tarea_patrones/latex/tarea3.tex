%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%% PAQUETES QUE UTILIZO %%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\documentclass[letter, 11pt, twoside]{report}
\usepackage{amsthm}
\usepackage[many]{tcolorbox}
\usepackage{thmtools}
\usepackage{amssymb,bm,amsfonts,amsmath}
\usepackage[utf8]{inputenc}
\usepackage[spanish]{babel}
\usepackage[export]{adjustbox}
\usepackage{hyperref}
\usepackage{enumerate}
\usepackage{makeidx}
\usepackage{float}
\usepackage{graphicx, import}
\usepackage{subfig}
\usepackage{upgreek}
\usepackage{float}
\usepackage[all]{xy}
\usepackage{thmtools}
\usepackage{titlesec}
\usepackage{mathrsfs}
\usepackage{multicol}
\usepackage{tikz-cd}
\usetikzlibrary{patterns}
\usetikzlibrary{plotmarks}
\usepackage{wrapfig}
\usepackage{stmaryrd}
\usepackage{subfloat}
\usepackage{svg}
\usepackage{yfonts}
\usepackage{fancyhdr}
\usepackage{pifont}
\usepackage{pdfpages}
\usepackage{ marvosym }
\usepackage{hyperref}
\usepackage{pdflscape}
\usepackage{setspace}
\usepackage{color}
\usepackage{bm}
\usepackage{epigraph}
\usepackage{quotchap}
\usepackage[framemethod=TikZ]{mdframed}
\usepackage[nottoc,numbib]{tocbibind}
\usepackage[customcolors]{hf-tikz}
\usetikzlibrary{babel}
% PARA VER LAS REFERENCIAS LABELS
% \usepackage[notcite,color]{showkeys}
% CHECA http://www.tug.dk/FontCatalogue/iwonalightcondensed/
\usepackage[light,math]{iwona}
\usepackage[T1]{fontenc}
\usepackage{MnSymbol}
\usepackage{varwidth} % CAJA DE EJERCICIOS Y \SOMBREADO
\tcbuselibrary{vignette,many}
\tcbuselibrary{skins}
\usepackage{pgfplots}
\usepgfplotslibrary{fillbetween}
\pgfplotsset{compat=1.16}
\usepackage{xcolor}
% PARA ESCRIBIS CÓDIGO Y PSEUDOCÓDIGO
\usepackage{algorithm}
\usepackage{algpseudocode}
\usepackage{listings}
\usepackage{color, xcolor}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%% MEMO PYTHON Y C %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%CÓMO QUEDERÁ EL COLOREADO Y HIGHLIGHT DEL CÓDIGO
\definecolor{dkgreen}{rgb}{0.9,0.6,0.8}
\definecolor{blue}{rgb}{0.0,0.49,0.4}
\definecolor{gray97}{gray}{.97}
\definecolor{gray75}{gray}{.75}
\definecolor{gray45}{gray}{.45}
\definecolor{codepurple}{rgb}{0.58,0,0.82}
\definecolor{backcolour}{rgb}{0.95,0.95,0.92}
\definecolor{codegreen}{rgb}{0,0.6,0}
\definecolor{codegray}{rgb}{0.5,0.5,0.5}

\lstdefinestyle{mystyle}{
    backgroundcolor=\color{gray97},
    commentstyle=\color{cyan!75!black},
    keywordstyle=\color{magenta},
    numberstyle=\tiny\color{codegray},
    stringstyle=\color{codepurple},
    basicstyle=\ttfamily\footnotesize,
    breakatwhitespace=false,
    breaklines= true,
    captionpos=b,
    keepspaces=true,
    numbers=left,
    numbersep=5pt,
    showspaces=false,
    showstringspaces=false,
    showtabs=false,
    tabsize=2,
    language=bash,   %% PHP, C, Java, etc... bash is the standard
    extendedchars=true,
    inputencoding=latin1
}

\lstset{style=mystyle, literate =
                        {í}{{\'i}}1
                        {á}{{\'a}}1
                        {é}{{\'e}}1
                        {ó}{{\'o}}1
                        {ú}{{\'u}}1
                        {ñ}{{\~n}}1
                        {ü}{{\"u}}1
                            }

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%% COLORES DEL PAQUETE SHOWKEYS %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\definecolor{refkey}{rgb}{255,0,0}
\definecolor{labelkey}{rgb}{255,0,0}
\definecolor{mirosa}{HTML}{FF007F}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%% MARGENES, VIENE EN EL MANUAL DE LATEX %%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%% FORMATO ME LO PASO RO %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\parskip=5pt
\hoffset = 0pt
\headsep = 1.5 cm % estaba en 1.5 cm, lo cambie para el header de la imagen
\oddsidemargin = .5cm
\evensidemargin = .5cm
\textheight = 657pt
\textwidth = 15.6cm
\topmargin = -2 cm
\parindent=0mm

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%% CREACIÓN DE EJERCICIO %%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%% MODIFICACIÓN PROOF Y QED %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\renewcommand{\qedsymbol}{\tiny{$\blacksquare$}}

\newenvironment{solucion}{\begin{proof}[\textcolor{magenta}{Solución}]}{\end{proof}}

\newtcolorbox[auto counter]{ejercicio}[1][]{
% ESTO ES PARA LA CAJA GENERAL
breakable, % por si cambias de pagina
enhanced, % estilo general
% TITULO MODIFICACIONES
coltitle= black,
colbacktitle= white,
titlerule= 0mm,
colframe = magenta,
fonttitle=\bfseries,
title= Ejercicio~\thetcbcounter,
% CAJA LINEA MODIFICACIONES
boxed title style={
  sharp corners,
  rounded corners=northwest,
  rounded corners=northeast,
  % outer arc=0pt,
  % arc=0pt,
  },
% CONTENIDO MODIFICACIONES
colback = white,
fontupper = \itshape,
coltext =  black,
% MARCO MODIFICACIONES
rightrule=0mm,
toprule=0pt,
bottomrule= 0pt,
leftrule = 4pt
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%% CREE COMANDOS PARA FACILITAR ESCRITURA %%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\newcommand{\I}[4]{\displaystyle\int\limits_#1^#2 #3 \,\text{d}#4}
\newcommand{\III}[2]{\displaystyle\int#1 \,\text{d}#2}
\newcommand{\II}[1]{\displaystyle\int#1 \,\text{d$x$}}
\newcommand{\fun}[3]{$#1:#2 \longrightarrow #3$}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%% MODIFIQUE ALGUNOS COMANDOS %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%% EL INTERLINEADO %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\renewcommand{\baselinestretch}{1}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%% COLUMNAS ES AMBIENTE MULTICOLS %%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\setlength{\columnseprule}{1pt}
\def\columnseprulecolor{\color{darktangerine}}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%% ESPACIO ENTRE RENGLONES,COLUMNAS MATRIX  Y THICK DE \FCOLORBOX %%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\renewcommand{\arraystretch}{1.2} % for the vertical padding (space)
\setlength{\tabcolsep}{0.2 cm} % for the horizontal padding  (space)
\setlength{\fboxrule}{3pt}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%% ESTILO DE LA PÁGINAS %%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\pagestyle{fancy}
\fancyhf{}
\fancyhead[RE, RO]{}
\fancyhead[LE, LO]{}
\fancyfoot[CE,CO]{\thepage}
\fancyfoot[RE,RO]{\small{\textsc{Y. Sarahi García González}}}
\fancyfoot[LE,LO]{\small{\textsc{Reconocimiento estadístico de patrones}}}
\chead{\includegraphics[scale=.3]{/Users/ely/Documents/Plantilla/Figures/waves.pdf}}
\renewcommand{\headrulewidth}{0pt}
\renewcommand{\footrulewidth}{0pt}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%% CAPÍTULOS MISMA PÁGINA %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\usepackage{etoolbox}
\makeatletter
\patchcmd{\chapter}{\if@openright\cleardoublepage\else\clearpage\fi}{}{}{}
\makeatother

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%% EMPEZAMOS %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{document}
\synctex=1 % PARA SINCRONIZAR PDF AL PRESIONAR
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% \begin{savequote}[45mm]
% ---Frase---
% \qauthor{Guillermo Gachuz Atitlán}
% \end{savequote}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\chapter*{\begin{tabular}{p{12cm}  c}
   \begin{flushright}
    Tarea III\\\small{Y. Sarahi Grcía González}
   \end{flushright} & \includegraphics[scale=0.3, raise =-2cm]{/Users/ely/Documents/Plantilla/Figures/cimat.png} \\
  \end{tabular} }
\vspace{-2cm}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


{\color{mirosa}\section*{Problema 1}}
Verifica la igualdad que vimos en la clase:
\begin{equation*}
 \frac{1}{2} \sum_{k=1}^K  \sum_{i: g(i)=k}  \sum_{j: g(j)=k}   ||x_i - x_j||^2  = 
 \sum_{k=1}^K N_k  \sum_{i: g(i)=k}   ||x_i - \mu_k||^2 \mbox{ con } \mu_k= promedio \{x_i: g(i)=k\}
\end{equation*} \mbox{} \\
donde $N_k$ es el n\'umero de elementos en cluster $k$. Puedes limitarte al caso cuando $x\in {R}$. 

{\color{mirosa}Sol.}


Para aligerar la notación tomaremos $\sum_{i: g(i)=k}=\sum_{i}$ y lo mismo para $j$. Comenzamos enfocandonos en la suma sobre $j$ de lado izquierdo
$$
\begin{gathered}
    \sum_{j}   ||x_i - x_j||^2 =  \sum_{j}|x_i - x_j|^2=\sum_j\left|x_i-y_k-x_j+\mu_k\right|^2=\sum_j\left(\left(x_i-\mu_k\right)-\left(x_j-\mu_k\right)\right)^2 \\
=\sum_j\left[\left(x_i-\mu_k\right)^2-2\left(x_i-\mu_k\right)\left(x_j-\mu_k\right)+\left(x_i-\mu_k\right)^2\right] \\
\end{gathered}
$$
Donde usamos que, al estar en R, la norma es el valor absoluto y la propiedad del valor absoluto $|a|^2=(a)^2$.
Ahora, tomando en cuenta que $x_i$ y $\mu_k$ no dependen del indice j, se cumple que $\sum_j\left(x_i-\mu_k\right)^2=N_k\left(x_i-\mu_k\right)^2$,
por lo que:

$$=N_k\left(x_i-\mu_k\right)^2-2\left(x_i-\mu_k\right) \sum_j\left(x_j-\mu_k\right)+\sum_j\left(x_j-\mu_k\right)^2$$
Ahora, tomamos la suma sobre $i$
$$
\begin{aligned}
    \sum_{i}  \sum_{j}   ||x_i - x_j||^2 =& N_k \sum_i\left(x_i-\mu_k\right)^2-2 \sum_i\left(x_i-\mu_k\right) \sum_j\left(x_j-\mu_k\right)+N_k \sum_j\left(x_j-M_k\right)^2 \\
& =2 N_k \sum_i\left(x_i-\eta_k\right)^2-2 \sum_i\left(x_i-\mu_k\right) \sum_j\left(x_j-M k\right) \\
\end{aligned}
$$
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

Pero $\sum\left(x_i-\mu_k\right)=k\left(N_k\left(\frac{\sum_i x_i}{N_k}\right)-N_k \mu_k\right)=\left(N_k \mu_k-N_k \mu_k\right)=0$

De modo que:

$$  \sum_i \sum_j\left\|x_i-x_j\right\|^2=2N_k \sum\left(x_i-\eta_k\right)^2+0$$

Ahora, tomamos la suma sobre $k$


\begin{equation*}
    \sum_{k=1}^K  \sum_{i}  \sum_{j}   ||x_i - x_j||^2  = 
    \sum_{k=1}^K 2N_k  \sum_{i}   ||x_i - \mu_k||^2 
   \end{equation*}
   
Y, finalmente dividiendo entre 2:

\begin{equation*}
    \frac{1}{2}\sum_{k=1}^K  \sum_{i}  \sum_{j}   ||x_i - x_j||^2  = 
    \sum_{k=1}^K N_k  \sum_{i}   ||x_i - \mu_k||^2 
   \end{equation*}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

{\color{mirosa}\section*{Problema 2}}


   Sea la f\'ormula  de \textbf{average linkage} que se usa para un \textbf{Algoritmo Jerarquico Aglomerativo}
   \begin{eqnarray}
   d(C_i, C_j) &=&  {\displaystyle {\frac {1}{|C_i|\cdot |C_j|}}\sum _{\textbf{x}\in C_i}\sum _{\textbf{y}\in C_j}d(\textbf{x},\textbf{y}).}
   \end{eqnarray}
   donde $|C_i|$ y  $|C_j|$ representan la cardinalidad de los clusters $C_i$ y $C_j$ respectivamente, y $d(\textbf{x},\textbf{y})$ una medida de distancia entre $\textbf{x}$ y $\textbf{y}$. 
   
   En cada paso, los clusters mas cercanos $C_i$ y $C_j$ se combinan   en un nuevo cluster $C_i\cup C_j$.
   Muestra que la distancia del  cluster $C_i\cup C_j$ a otro cluster $C_k$ se puede calcular mediante la f\'ormula recursiva:
   \begin{eqnarray*}
   d(C_i\cup C_j,C_k) &=&{\frac {|C_i|\cdot d({C_i},C_k)+|{C_j}|\cdot d(C_j,C_k)}{|{C_i}|+|C_j|}}
   \end{eqnarray*}

   {\color{mirosa}Sol.}

   Nuevamente, para aligerar la notación haremos un pequeño cambio: $\sum_{\textbf{x}\in C_i}=\sum_{i}$ y lo
   mismo para $j$ y $k$. Partimos del lado derecho de la expresión anterior y aplicamos la ecuacion 1.

\begin{align*}
    \frac {|C_i|\cdot d({C_i},C_k)+|{C_j}|\cdot d(C_j,C_k)}{|{C_i}|+|C_j|}=&\frac{1}{|C_i|+|C_j|}\left[\left(\frac{|C_i|}{|C_i||C_k|}\right)\sum_{i} \sum_{k} d(x, y)+ \left(\frac{|C_j|}{|C_j||C_k|}\sum_{j} \sum_{k} d(x, y)\right)\right]\\
    &=\frac{1}{|C_i\cup C_j|}\left[\frac{1}{|C_k|}\sum_{i} \sum_{k} d(x, y)+ \frac{1}{|C_k|}\sum_{j} \sum_{k} d(x, y)\right]\\
    &=\frac{1}{|C_i\cup C_j|C_k||}\left[\sum_{i} \sum_{k} d(x, y)+ \sum_{j} \sum_{k} d(x, y)\right]\\
    &=\frac{1}{|C_i\cup C_j|C_k||}\left[\sum_{i,j} \sum_{k} d(x, y)\right]=d(C_i\cup C_j,C_k)
\end{align*}
 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\end{document}
